# ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ ูู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุชุฌุฑ ูุงูุนููู

## ุงููุทููุจ
ุนูุฏ ุชุบููุฑ ุญุงูุฉ ุงูุทูุจุ ูุฌุจ ุชุญุฏูุซ ุงูุญุงูุฉ ูู ููุงููู:
1. **ูุงุนุฏุฉ ุจูุงูุงุช ุงููุชุฌุฑ**: `/markets/{marketId}/present_order/{orderId}`
2. **ูุงุนุฏุฉ ุจูุงูุงุช ุงูุนููู**: `/users/{userId}/orders/{orderId}`

ูุน ูุชุงุจุฉ ุงูุญุงูุฉ ุจุงูุนุฑุจูุฉ ูุจุงุดุฑุฉ ูู ุญูู `status`.

## ุงูุชุญุฏูุซุงุช ุงููุทุจูุฉ

### 1. ุชุญุฏูุซ ุฏุงูุฉ `_updateOrderStatus`

```dart
Future<void> _updateOrderStatus(String documentId, String newStatus) async {
  // ... ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
  
  try {
    // ุฅุธูุงุฑ ูุคุดุฑ ุงูุชุญููู
    showDialog(context: context, ...);
    
    // ุฌูุจ ุจูุงูุงุช ุงูุทูุจ ููุญุตูู ุนูู ูุนุฑู ุงูุนููู
    final orderDoc = await FirebaseFirestore.instance
        .collection('markets')
        .doc(widget.marketId)
        .collection('present_order')
        .doc(documentId)
        .get();
    
    final orderData = orderDoc.data() as Map<String, dynamic>;
    final customerInfo = orderData['customerInfo'] as Map<String, dynamic>? ?? {};
    final customerId = customerInfo['userId'] as String?;
    
    // ุชุญุฏูุซ ุงูุญุงูุฉ ูู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุชุฌุฑ
    await FirebaseFirestore.instance
        .collection('markets')
        .doc(widget.marketId)
        .collection('present_order')
        .doc(documentId)
        .update({
      'status': newStatus, // ูุชุงุจุฉ ุงูุญุงูุฉ ุจุงูุนุฑุจูุฉ ูุจุงุดุฑุฉ
      'updatedAt': FieldValue.serverTimestamp(),
    });
    
    // ุชุญุฏูุซ ุงูุญุงูุฉ ูู ูุงุนุฏุฉ ุจูุงูุงุช ุงูุนููู
    if (customerId != null && customerId.isNotEmpty) {
      await FirebaseFirestore.instance
          .collection('users')
          .doc(customerId)
          .collection('orders')
          .doc(documentId)
          .update({
        'status': newStatus, // ูุชุงุจุฉ ุงูุญุงูุฉ ุจุงูุนุฑุจูุฉ ูุจุงุดุฑุฉ
        'updatedAt': FieldValue.serverTimestamp(),
      });
    }
    
    // ุฅุบูุงู ูุคุดุฑ ุงูุชุญููู ูุฅุธูุงุฑ ุฑุณุงูุฉ ูุฌุงุญ
    Navigator.pop(context);
    ScaffoldMessenger.of(context).showSnackBar(...);
    
  } catch (e) {
    // ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
  }
}
```

### 2. ุชุญุฏูุซ ุฏุงูุฉ `_convertStatusToArabic`

```dart
String _convertStatusToArabic(String status) {
  // ุฅุฐุง ูุงูุช ุงูุญุงูุฉ ุจุงููุนู ุจุงูุนุฑุจูุฉุ ุงุฑุฌุนูุง ููุง ูู
  if (status == 'ููุฏ ุงููุฑุงุฌุนุฉ' || 
      status == 'ุชู ุงุณุชูุงู ุงูุทูุจ' || 
      status == 'ุฌุงุฑู ุชุณููู ููุฏูููุฑู' || 
      status == 'ุชู ุงูุชุณููู ููุทูุงุฑ' || 
      status == 'ุชู ุฑูุถ ุงูุทูุจ') {
    return status;
  }
  
  // ุฅุฐุง ูุงูุช ุจุงูุฅูุฌููุฒูุฉุ ุญูููุง ููุนุฑุจูุฉ
  switch (status.toLowerCase()) {
    case 'pending': return 'ููุฏ ุงููุฑุงุฌุนุฉ';
    case 'accepted': return 'ุชู ุงุณุชูุงู ุงูุทูุจ';
    case 'preparing': return 'ุฌุงุฑู ุชุณููู ููุฏูููุฑู';
    case 'delivered': return 'ุชู ุงูุชุณููู ููุทูุงุฑ';
    case 'rejected': return 'ุชู ุฑูุถ ุงูุทูุจ';
    default: return status;
  }
}
```

### 3. ุฅุฒุงูุฉ ุฏุงูุฉ `_convertStatusToEnglish`

ุชู ุญุฐู ูุฐู ุงูุฏุงูุฉ ูุฃููุง ูู ูุนุฏ ูุญุชุงุฌ ูุชุญููู ุงูุญุงูุงุช ุฅูู ุงูุฅูุฌููุฒูุฉ.

## ุงูุญุงูุงุช ุงููุฏุนููุฉ

| ุงูุญุงูุฉ ุจุงูุนุฑุจูุฉ | ุงููุตู |
|----------------|--------|
| ููุฏ ุงููุฑุงุฌุนุฉ | ุทูุจ ุฌุฏูุฏ ูุญุชุงุฌ ูุฑุงุฌุนุฉ |
| ุชู ุงุณุชูุงู ุงูุทูุจ | ุชู ูุจูู ุงูุทูุจ ูู ุงููุชุฌุฑ |
| ุฌุงุฑู ุชุณููู ููุฏูููุฑู | ุงูุทูุจ ุฌุงูุฒ ููุชุณููู |
| ุชู ุงูุชุณููู ููุทูุงุฑ | ุชู ุชุณููู ุงูุทูุจ ููุทูุงุฑ |
| ุชู ุฑูุถ ุงูุทูุจ | ุชู ุฑูุถ ุงูุทูุจ |

## ูุณุงุฑุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ูุงุนุฏุฉ ุจูุงูุงุช ุงููุชุฌุฑ
```
/markets/{marketId}/present_order/{orderId}
```

ูุซุงู:
```
/markets/kb/present_order/kb_2510270957_PPHQN6
```

### ูุงุนุฏุฉ ุจูุงูุงุช ุงูุนููู
```
/users/{userId}/orders/{orderId}
```

ูุซุงู:
```
/users/r45gk7i6ulegw2s51hNzE4C9t7H3/orders/kb_2510271106_9WA38K
```

## ูููู ุงูุจูุงูุงุช ุงููุญุฏุซ

```json
{
  "orderId": "kb_2510270957_PPHQN6",
  "status": "ููุฏ ุงููุฑุงุฌุนุฉ",
  "updatedAt": "2025-01-27T09:57:00Z",
  "customerInfo": {
    "userId": "r45gk7i6ulegw2s51hNzE4C9t7H3",
    "name": "ุงุณู ุงูุนููู",
    "phone": "01012345678",
    "address": "ุงูุนููุงู"
  },
  "items": [...],
  "totalAmount": 150.0
}
```

## ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### โ ุชุญุฏูุซ ูุฒุฏูุฌ
- ุชุญุฏูุซ ุงูุญุงูุฉ ูู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุชุฌุฑ
- ุชุญุฏูุซ ุงูุญุงูุฉ ูู ูุงุนุฏุฉ ุจูุงูุงุช ุงูุนููู

### โ ูุชุงุจุฉ ุจุงูุนุฑุจูุฉ
- ุงูุญุงูุฉ ุชููุชุจ ุจุงูุนุฑุจูุฉ ูุจุงุดุฑุฉ ูู ุญูู `status`
- ูุง ุญุงุฌุฉ ูุชุญููู ุฅูู ุงูุฅูุฌููุฒูุฉ

### โ ูุคุดุฑ ุงูุชุญููู
- ุฅุธูุงุฑ ูุคุดุฑ ุงูุชุญููู ุฃุซูุงุก ุงูุชุญุฏูุซ
- ุฅุบูุงู ุงููุคุดุฑ ุนูุฏ ุงูุงูุชูุงุก ุฃู ูู ุญุงูุฉ ุงูุฎุทุฃ

### โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
- ูุญุต ูุฌูุฏ ุงูุทูุจ ูุจู ุงูุชุญุฏูุซ
- ูุนุงูุฌุฉ ุฃุฎุทุงุก ุชุญุฏูุซ ูุงุนุฏุฉ ุจูุงูุงุช ุงูุนููู ุจุดูู ูููุตู
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ููููุฏุฉ

### โ ุงูุชูุงูู ูุน ุงูุจูุงูุงุช ุงููุฏููุฉ
- ุฏุนู ุงูุญุงูุงุช ุงูุฅูุฌููุฒูุฉ ุงููุฏููุฉ
- ุชุญููู ุชููุงุฆู ููุญุงูุงุช ุงูุฅูุฌููุฒูุฉ ุฅูู ุงูุนุฑุจูุฉ

## ูุซุงู ุนูู ุงูุงุณุชุฎุฏุงู

```dart
// ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ "ุงุณุชูุงู ุงูุทูุจ"
onStatusChange: (newStatus) {
  final documentId = order['documentId'];
  if (documentId != null) {
    _updateOrderStatus(documentId, newStatus);
  }
}
```

## ุงุฎุชุจุงุฑ ุงููุธุงู

1. **ุชุบููุฑ ุญุงูุฉ ุทูุจ**: ุงุถุบุท ุนูู ุฃู ุฒุฑ ุชุบููุฑ ุญุงูุฉ
2. **ุชุญูู ูู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุชุฌุฑ**: ุชุฃูุฏ ูู ุชุญุฏูุซ ุงูุญุงูุฉ
3. **ุชุญูู ูู ูุงุนุฏุฉ ุจูุงูุงุช ุงูุนููู**: ุชุฃูุฏ ูู ุชุญุฏูุซ ุงูุญุงูุฉ
4. **ุชุญูู ูู ุงููุบุฉ**: ุชุฃูุฏ ูู ูุชุงุจุฉ ุงูุญุงูุฉ ุจุงูุนุฑุจูุฉ
5. **ุชุญูู ูู ุงููุคุดุฑ**: ุชุฃูุฏ ูู ุธููุฑ ูุคุดุฑ ุงูุชุญููู

ุงููุธุงู ุงูุขู ูุญุฏุซ ุงูุญุงูุฉ ูู ููุง ุงูููุงููู ุจุงูุนุฑุจูุฉ! ๐
